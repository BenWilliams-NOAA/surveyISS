<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started • surveyISS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="surveyISS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveyISS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/spatial_iss.html">SC: Spatially-explicit ISS</a>
    </li>
    <li>
      <a href="../articles/stock_complex.html">SC: Stock complex ISS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BenWilliams-NOAA/surveyISS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BenWilliams-NOAA/surveyISS/blob/HEAD/vignettes/getting_started.Rmd" class="external-link"><code>vignettes/getting_started.Rmd</code></a></small>
      <div class="hidden name"><code>getting_started.Rmd</code></div>

    </div>

    
    
<p>The following describes the workflow to obtain bottom trawl survey
input sample size (ISS) for composition data that is used in AFSC stock
assessments.</p>
<p><em>Step 1.</em> Connect to VPN or network.</p>
<p><em>Step 2.</em> Download the <code>surveyISS</code> package
(assuming that you have the <code>devtools</code> package
installed).</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"BenWilliams-NOAA/surveyISS"</span><span class="op">)</span></span></code></pre>
<p><em>Step 3.</em> Load the <code>surveyISS</code> library.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BenWilliams-NOAA/surveyISS/" class="external-link">surveyISS</a></span><span class="op">)</span></span></code></pre></div>
<p><em>Step 4.</em> Query the data for your stock. The following is an
example for GOA Pacific cod:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">surveyISS</span><span class="fu">::</span><span class="fu"><a href="../reference/query_data.html">query_data</a></span><span class="op">(</span>survey <span class="op">=</span> <span class="fl">47</span>, </span>
<span>                              region <span class="op">=</span> <span class="st">'goa'</span>, </span>
<span>                              species <span class="op">=</span> <span class="fl">21720</span>, </span>
<span>                              yrs <span class="op">=</span> <span class="fl">1990</span><span class="op">)</span></span></code></pre>
<p>There are a couple of special cases that can be integrated within the
<code><a href="../reference/query_data.html">surveyISS::query_data()</a></code> function that should be noted.</p>
<p>First, for stock complexes, data for multiple species can be pulled
at once. The following is an example for the AI Blackspotted-Rougheye
rockfish complex:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">surveyISS</span><span class="fu">::</span><span class="fu"><a href="../reference/query_data.html">query_data</a></span><span class="op">(</span>survey <span class="op">=</span> <span class="fl">52</span>, </span>
<span>                              region <span class="op">=</span> <span class="st">'ai'</span>, </span>
<span>                              species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30050</span>, <span class="fl">30051</span>, <span class="fl">30052</span><span class="op">)</span>, </span>
<span>                              yrs <span class="op">=</span> <span class="fl">1991</span><span class="op">)</span></span></code></pre>
<p>Second, the <code><a href="../reference/query_data.html">surveyISS::query_data()</a></code> function can pull
multiple survey regions and combine the data into a single dataframe.
The following is an example for Walleye pollock sampled in the NBS and
EBS survey regions:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">surveyISS</span><span class="fu">::</span><span class="fu"><a href="../reference/query_data.html">query_data</a></span><span class="op">(</span>survey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">143</span><span class="op">)</span>, </span>
<span>                              region <span class="op">=</span> <span class="st">'nebs'</span>, </span>
<span>                              species <span class="op">=</span> <span class="fl">21740</span>, </span>
<span>                              yrs <span class="op">=</span> <span class="fl">1982</span><span class="op">)</span></span></code></pre>
<p>For further details on the <code><a href="../reference/query_data.html">surveyISS::query_data()</a></code>
function, including the data that are pulled and description of the
arguments please see the R Documentation. The data that is pulled will
be saved as csv files within a subfolder of the <code>data</code> folder
which is defined as whatever you specified <code>region</code> to be in
the <code><a href="../reference/query_data.html">surveyISS::query_data()</a></code> function (e.g., for the GOA
Pacific cod example the data would be written to the
<code>data\goa</code> folder).</p>
<p><em>Step 5.</em> Run the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> function
to obtain ISS for your stock. The following is an example for standard
age and length composition ISS using the GOA Pacific cod example in
<em>Step 4</em> (with 10 iterations as a test):</p>
<pre><code><span><span class="fu">surveyISS</span><span class="fu">::</span><span class="fu"><a href="../reference/srvy_iss.html">srvy_iss</a></span><span class="op">(</span>iters <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                    lfreq_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">lfreq</span>,</span>
<span>                    specimen_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">specimen</span>, </span>
<span>                    cpue_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">cpue</span>, </span>
<span>                    strata_data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">strata</span>,</span>
<span>                    yrs <span class="op">=</span> <span class="fl">1990</span>,  </span>
<span>                    boot_hauls <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    boot_lengths <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    boot_ages <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    al_var <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    al_var_ann <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    age_err <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    region <span class="op">=</span> <span class="st">'goa'</span>, </span>
<span>                    save <span class="op">=</span> <span class="st">'test'</span><span class="op">)</span></span></code></pre>
<p>Please see the R Documentation for description of the arguments used
in the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> function (including several
that aren’t defined in this example). While we set the number of
iterations here at 10 as a test, we recommend at least 500 iterations be
performed when running the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> function
to obtain ISS (this recommendation is based upon tests for when the ISS
stabilized across the replicates).</p>
<p>We note that there are several special cases that were developed
based upon the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> function; these
special cases include stock complex, spatially-explicit, and conditional
age-at-length cases. Please see the associated vignettes for examples of
using the <code>surveyISS</code> package and description of the specific
output for these cases.</p>
<p><em>Step 6.</em> Obtain and evaluate output.</p>
<p>For the standard <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> example in
<em>Step 5</em> (and for most special cases except condition
age-at-length) there will be two output files:</p>
<ol style="list-style-type: decimal">
<li>
<em>save</em>_iss_age.csv is the ISS for age composition data (where
<em>save</em> is whatever text string you defined the argument
<code>save</code> as in the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> run in
<em>Step 5</em>), and,</li>
<li>
<em>save</em>_iss_ln.csv is the ISS for length composition data</li>
</ol>
<p>These two files will be written to a subfolder within the
<code>output</code> folder that is defined as whatever text string you
used to define the <code>region</code> argument in the
<code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> run in <em>Step 5</em> (similar to
how the queried data is saved, for this example for GOA Pacific cod the
output will be stored in the <code>output\goa</code> folder).</p>
<p>The following is a description of the columns that are included in
the age and length composition ISS output:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>year</td>
<td>The year for which the ISS has been computed for the age/length
composition data</td>
</tr>
<tr class="even">
<td>species_code</td>
<td>The RACE species code for you stock (e.g., 21720 for Pacific
cod)</td>
</tr>
<tr class="odd">
<td>sex</td>
<td>The sex category for which the age/length composition ISS has been
computed. The following is a description for each numerical value:</td>
</tr>
<tr class="even">
<td></td>
<td>0 - combined sex age/length composition, where the length frequency
and specimen data have been combined to a single sex prior to
design-based expansion</td>
</tr>
<tr class="odd">
<td></td>
<td>1 - male age/length composition</td>
</tr>
<tr class="even">
<td></td>
<td>2 - female age/length composition</td>
</tr>
<tr class="odd">
<td></td>
<td>12 - male-female age/length composition where the composition data
sum to 1 across both sexes (rather than sum to one for each individual
sex as for categories 1 or 2)</td>
</tr>
<tr class="even">
<td></td>
<td>4 - combined sex age/length composition, where the age/length
design-based population estimates are summed post-expansion and then
age/length composition is computed (this has been the status quo for
single-sex stock assessments)</td>
</tr>
<tr class="odd">
<td>sex_desc</td>
<td>Text string with short description of sex category</td>
</tr>
<tr class="even">
<td>iss</td>
<td>Input sample size</td>
</tr>
<tr class="odd">
<td>nss</td>
<td>Nominal sample size (the number of lengths collected or ages
read)</td>
</tr>
<tr class="even">
<td>nhls</td>
<td>The number of hauls from which samples were collected</td>
</tr>
</tbody>
</table>
<p>Within the <code><a href="../reference/srvy_iss.html">surveyISS::srvy_iss()</a></code> there are two arguments
for additional output that can be created if you so desire (currently
default = FALSE, and thus aren’t included in the example provided in
<em>Step 5</em>).</p>
<p>The first is the <code>save_interm</code> argument, which saves the
intermediate results. These include:</p>
<ol style="list-style-type: decimal">
<li>
<em>save</em>_resampled_length.csv and
<em>save</em>_resampled_age.csv which are the expanded age and length
population numbers for each bootstrap replicate (WARNING: for a large
number of iterations these files will become very big, like ’uge
big).</li>
<li>
<em>save</em>_iter_rss_ln.csv and <em>save</em>_iter_rss_ag.csv
which are the realized sample sizes (computed following McAllister and
Ianelli 1997) for each bootstrap replicate (where the ISS is then
computed as the harmonic mean of these realized sample sizes)</li>
</ol>
<p>The second is the <code>save_stats</code> argument, which saves
several statistics that could be of interest. These include:</p>
<ol style="list-style-type: decimal">
<li>
<em>save</em>_base_length.csv and <em>save</em>_base_age.csv which
are the age and length population numbers expanded without any bootstrap
resampling. Note, these are the same values that are provided in the
GAP_PRODUCTS tables for age and length composition (in the
AKFIN_SIZECOMP and AKFIN_AGECOMP tables). We recommend, unless you’re
using a special case function, that you get the age and length
population estimates that are then used for age/length composition in
your stock assessment from the GAP_PRODUCTS tables hosted on AKFIN.</li>
<li>
<em>save</em>_bias_length.csv and <em>save</em>_bias_age.csv which
are the bias in the bootstrapped age/length composition, computed as the
mean bias in the bootstrap replicated age/length compositions (where the
bias is computed as the difference between the replicated age/length
composition and the mean age/length composition across the bootstrap
replicates).</li>
<li>
<em>save</em>_mean_length.csv which is the mean length-at-age,
computed following the method used in the <code>gapindex</code> package.
In addition to the mean and SD in length-at-age computed without any
bootstrap resampling (which is the standard output provided in the
GAP_PRODUCTS.AKFIN_AGECOMP table) you are also provided the mean and SD
in length-at-age across the bootstrap replicates (which, if desired
would include ageing error and growth varaibility)</li>
</ol>
<p><em>Step 7.</em> Filter the ISS to your desired sex category and
implement within your stock assessment. Best of luck!</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ben Williams, Pete Hulson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
